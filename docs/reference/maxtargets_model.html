<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prepare a maximum target coverage prioritization problem — maxtargets_model • prioritizr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">prioritizr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mstrimas/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare a maximum target coverage prioritization problem</h1>
    </div>

    
    <p>Specify a maximum target coverage systematic conservation prioritization
problem from input data in a variety of formats. These are constructor
functions for <code>maxtargets_model</code> objects which encapsulate
prioritization problems in a standardized format.</p>
    

    <pre><span class='fu'>maxtargets_model</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for numeric</span>
<span class='fu'>maxtargets_model</span>(<span class='no'>x</span>, <span class='no'>targets</span>, <span class='no'>budget</span>, <span class='no'>rij</span>,
  <span class='kw'>locked_in</span> <span class='kw'>=</span> <span class='fu'>integer</span>(), <span class='kw'>locked_out</span> <span class='kw'>=</span> <span class='fu'>integer</span>(),
  <span class='kw'>target_type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"relative"</span>, <span class='st'>"absolute"</span>), <span class='no'>...</span>)

<span class='co'># S3 method for Raster</span>
<span class='fu'>maxtargets_model</span>(<span class='no'>x</span>, <span class='no'>features</span>, <span class='no'>targets</span>, <span class='no'>budget</span>, <span class='no'>rij</span>,
  <span class='kw'>locked_in</span> <span class='kw'>=</span> <span class='fu'>integer</span>(), <span class='kw'>locked_out</span> <span class='kw'>=</span> <span class='fu'>integer</span>(),
  <span class='kw'>target_type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"relative"</span>, <span class='st'>"absolute"</span>), <span class='no'>...</span>)

<span class='co'># S3 method for SpatialPolygons</span>
<span class='fu'>maxtargets_model</span>(<span class='no'>x</span>, <span class='no'>features</span>, <span class='no'>targets</span>, <span class='no'>budget</span>, <span class='no'>rij</span>,
  <span class='kw'>locked_in</span> <span class='kw'>=</span> <span class='fu'>integer</span>(), <span class='kw'>locked_out</span> <span class='kw'>=</span> <span class='fu'>integer</span>(),
  <span class='kw'>target_type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"relative"</span>, <span class='st'>"absolute"</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>x</dt>
      <dd>object specifying the planning units to use in the reserve design
  exercise and their corresponding cost. The possible types of objects are:

  <b><code>RasterLayer</code></b>: planning units are the raster cells and cell
  values should contain the repsective cost. If <code>x</code> is a RasterLayer, it
  may be desirable to exlcude some planning units from the analysis, for
  example those outside the study area. To exclude planning units, set the
  cost for those raster cells to <code>NA</code>.

 <b><code>SpatialPolygonsDataFrame</code></b>: polygons correspond to the planning
 units and there must be an attribute field named <code>cost</code>.

 <b><code>numeric vector</code></b>: a vector of planning unit costs. In this case
 the spatial representation of the planning units is not provided. Therefore,
 the <code>feature</code> argument is ignored and the representation matrix
 <code>rij</code> is required.

 <b><code>MarxanData</code></b>: a <code>MarxanData</code> object, from the <code>marxan</code>
  package (available at <a href = 'https://github.com/jeffreyhanson/marxan'>https://github.com/jeffreyhanson/marxan</a>),
 specifying a Marxan reserve design problem,
 which is equivalent to the minimum set cover problem. The <code>marxan</code>
 package can create <code>MarxanData</code> objects from a variety of data
 sources, including the standard Marxan input files. Thus this is valuable
 for those wanted to transition directly from Marxan. Note that all other
 arguments are ignored if x is a <code>MarxanData</code> object.</dd>
      <dt>...</dt>
      <dd>additional arguments passed on to methods</dd>
      <dt>targets</dt>
      <dd>numeric; representation targets either as proportion (between
0 and 1) of total representation level when <code>target_type = &quot;relative&quot;</code>
(the default), or absolute targets when <code>target_type = &quot;absolute&quot;</code>.
The order of the targets should match the ordering in the <code>features</code>
argument.</dd>
      <dt>budget</dt>
      <dd>numeric; budget for reserve.</dd>
      <dt>rij</dt>
      <dd>numeric matrix (optional); matrix of representation levels of
conservation features (rows) within planning units (columns). <code>rij</code>
can be a sparse matrix from the <code>slam</code> package (i.e. a
<code><a href='http://www.rdocumentation.org/packages/slam/topics/matrix'>simple_triplet_matrix</a></code>) or a normal base matrix object.
Alternatively, a data frame representation of this matrix with three
variables: feature index (<code>rij$feature</code>), planning unit index
(<code>rij$pu</code>), and corresponding representation level
(<code>rij$amount</code>). If this matrix is not provided it will be calculated
based on the planning units and RasterStack of conservation feature
distributions.</dd>
      <dt>locked_in</dt>
      <dd>integer; indices of planning units to lock in to final
solution. For example, it may be desirable to lock in planning units
already within protected areas. Alternatively, if <code>x</code> is a
<code>RasterLayer</code>, then <code>locked_in</code> can be a
binary <code>RasterLayer</code> with 1s identifying the planning units to lock
in.</dd>
      <dt>locked_out</dt>
      <dd>integer; indices of planning units to lock out of final
solution. For example, it may be desirable to lock in planning units that
are already heavily developed and therefore have little viable habitat.
Alternatively, if <code>x</code> is a <code>RasterLayer</code>, then <code>locked_out</code>
can be a binary <code>RasterLayer</code> with 1s identifying the planning units
to lock out.</dd>
      <dt>target_type</dt>
      <dd>&quot;relative&quot; or &quot;absolute&quot;; specifies whether the
<code>target</code> argument should be interpreted as relative to the total level
of representation or as an absolute target</dd>
      <dt>features</dt>
      <dd>RasterStack object; the distribution of conservation
features. Missing values (i.e. <code>NA</code>s) can be used to indicate the
absence of a feature in a particular cell instead of explicitly setting
these cells to zero. If <code>x</code> is a Raster object then <code>features</code>
should be defined on the same raster template. If <code>x</code> is a
SpatialPolygonsDataFrame <code>features</code> will be summarize over the
polygons using <code><a href='summarize_features.html'>summarize_features</a></code>. Not required if
<code>rij</code> is provided.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>maxtargets_model</code> object describing the prioritization
  problem to be solved. This is an S3 object consisting of a list with the
  following components:</p>
    <p><ul>
<li> <code>cost</code>: numeric vector of planning unit costs
  </li>
<li> <code>rij</code>: representation matrix
  </li>
<li> <code>targets</code>: absolute feature targets
  </li>
<li> <code>budget</code>: budget for reserve
  </li>
<li> <code>locked_in</code>: indices of locked in planning units
  </li>
<li> <code>locked_out</code>: indices of locked out planning units
  </li>
<li> <code>included</code>: logical vector indicating which planning units are
    to be included in the analysis. If all units are to be included, this is
    single value (<code>TRUE</code>). Using a subset of planning units is only
    permitted if the <code>x</code> argument is provided as a RasterLayer object.
</li>
</ul></p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The maximum target coverage problem is a modified version of the
  the maximum coverage problem (see <code><a href='maxcover_model.html'>maxcover_model</a></code>). Each
  conservation feature is assigned a representation target and the objective
  is to find the set of planning units that meets most targets
  while remaining within a fixed budget. The cost is often either the area of
  the planning units or the opportunity cost of foregone commericial
  activities (e.g. from logging or agriculture). Representation level is
  typically given by the occupancy within each planning unit, however, some
  measure of abundance or probability of occurence may also be used. The
  representation targets ensure that each species is adequately represented
  in the reserve network.</p>
    <p>This problem meant to be a hybrid between the maximum coverage problem and
  a Marxan-like minimum set cover problem in that it allows for both a budget
  and targets to be set.</p>
    
    <h2 class="hasAnchor" id="methods-by-class-"><a class="anchor" href="#methods-by-class-"></a>Methods (by class)</h2>

    <p><ul>
<li> <code>numeric</code>: Numeric vector of costs</p>
    <p></li>
<li> <code>Raster</code>: RasterLayer of planning units and corresponding
costs</p>
    <p></li>
<li> <code>SpatialPolygons</code>: SpatialPolygonsData frame of planning units with
cost attribute
</li>
</ul></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='minsetcover_model.html'>minsetcover_model</a></code> for the minimum set cover problem.
  <code><a href='maxcover_model.html'>maxcover_model</a></code> for the traditional maximum coverage
  problem.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># 5x5 raster template</span>
<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>extent</span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span>)
<span class='no'>r</span> <span class='kw'>&lt;-</span> <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>raster</span>(<span class='no'>e</span>, <span class='kw'>nrows</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncols</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>vals</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># generate 4 random feature distributions</span>
<span class='fu'>set.seed</span>(<span class='fl'>419</span>)
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>stack</span>(<span class='no'>r</span>, <span class='no'>r</span>, <span class='no'>r</span>, <span class='no'>r</span>)
<span class='no'>f</span>[] <span class='kw'>&lt;-</span> <span class='fu'>sample</span>(<span class='fl'>0</span>:<span class='fl'>1</span>, <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>nlayers</span>(<span class='no'>f</span>) * <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>ncell</span>(<span class='no'>f</span>), <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'>setNames</span>(<span class='no'>f</span>, <span class='no'>letters</span>[<span class='fl'>1</span>:<span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>nlayers</span>(<span class='no'>f</span>)])
<span class='co'># genrate cost layer</span>
<span class='no'>cost</span> <span class='kw'>&lt;-</span> <span class='no'>r</span>
<span class='no'>cost</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>ncell</span>(<span class='no'>cost</span>), <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='no'>cost</span> <span class='kw'>&lt;-</span> <span class='fu'>setNames</span>(<span class='no'>cost</span>, <span class='st'>"cost"</span>)

<span class='co'># prepare prioritization model with budget at 25% of total cost</span>
<span class='co'># and targets as 50% of the features' distributions</span>
<span class='no'>b_25</span> <span class='kw'>&lt;-</span> <span class='fl'>0.25</span> * <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>cellStats</span>(<span class='no'>cost</span>, <span class='st'>"sum"</span>)
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'>maxtargets_model</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>cost</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='no'>f</span>, <span class='kw'>budget</span> <span class='kw'>=</span> <span class='no'>b_25</span>,
                          <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

<span class='co'># the representation matrix (rij) can be supplied explicitly,</span>
<span class='co'># in which case the features argument is no longer required</span>
<span class='no'>rep_mat</span> <span class='kw'>&lt;-</span> <span class='fu'>unname</span>(<span class='fu'>t</span>(<span class='no'>f</span>[]))
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'>maxtargets_model</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>cost</span>, <span class='kw'>rij</span> <span class='kw'>=</span> <span class='no'>rep_mat</span>, <span class='kw'>budget</span> <span class='kw'>=</span> <span class='no'>b_25</span>,
                          <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

<span class='co'># cells can be locked in or out of the final solution</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'>maxtargets_model</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>cost</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='no'>f</span>, <span class='kw'>budget</span> <span class='kw'>=</span> <span class='no'>b_25</span>,
                          <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>locked_in</span> <span class='kw'>=</span> <span class='fl'>6</span>:<span class='fl'>10</span>,
                          <span class='kw'>locked_out</span> <span class='kw'>=</span> <span class='fl'>16</span>:<span class='fl'>20</span>)
<span class='co'># alternatively, binary rasters can be supplied indicating locked in/out</span>
<span class='no'>r_locked_in</span> <span class='kw'>&lt;-</span> <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>raster</span>(<span class='no'>r</span>)
<span class='no'>r_locked_in</span>[] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='co'># lock in cells 6-10</span>
<span class='no'>r_locked_in</span>[<span class='fl'>6</span>:<span class='fl'>10</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>model_raste_lock</span> <span class='kw'>&lt;-</span> <span class='fu'>maxtargets_model</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>cost</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='no'>f</span>, <span class='kw'>budget</span> <span class='kw'>=</span> <span class='no'>b_25</span>,
                                     <span class='kw'>locked_in</span> <span class='kw'>=</span> <span class='no'>r_locked_in</span>, <span class='kw'>targets</span><span class='kw'>=</span><span class='fl'>0.5</span>,
                                     <span class='kw'>locked_out</span> <span class='kw'>=</span> <span class='fl'>16</span>:<span class='fl'>20</span>)

<span class='co'># if some cells are to be excluded, e.g. those outside study area, set</span>
<span class='co'># the cost to NA for these cells.</span>
<span class='no'>cost_na</span> <span class='kw'>&lt;-</span> <span class='no'>cost</span>
<span class='no'>cost_na</span>[<span class='fl'>6</span>:<span class='fl'>10</span>] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>model_na</span> <span class='kw'>&lt;-</span> <span class='fu'>maxtargets_model</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>cost_na</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='no'>f</span>, <span class='kw'>budget</span> <span class='kw'>=</span> <span class='no'>b_25</span>,
                             <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)
<span class='co'># the model object now contains an included component specifying which</span>
<span class='co'># cells are to be included</span>
<span class='no'>model_na</span>$<span class='no'>included</span></div><div class='output co'>#&gt;  [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE
#&gt; [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
#&gt; [25]  TRUE</div><div class='input'><span class='fu'>which</span>(!<span class='no'>model_na</span>$<span class='no'>included</span>)</div><div class='output co'>#&gt; [1]  6  7  8  9 10</div><div class='input'><span class='co'># note that the representation matrix now has fewer columns because</span>
<span class='co'># the decision variables corresponding to excluded cells have been removed</span>
<span class='fu'>dim</span>(<span class='no'>model</span>$<span class='no'>rij</span>)</div><div class='output co'>#&gt; [1]  4 25</div><div class='input'><span class='fu'>dim</span>(<span class='no'>model_na</span>$<span class='no'>rij</span>)</div><div class='output co'>#&gt; [1]  4 20</div><div class='input'>
<span class='co'># planning units can also be supplied as a SpatialPolygonsDataFrame object</span>
<span class='co'># with cost stored as an attribute (x$cost). Typically the function takes</span>
<span class='co'># longer to execute with polygons because summarizing features over planning</span>
<span class='co'># units is less efficient.</span>
<span class='no'>cost_spdf</span> <span class='kw'>&lt;-</span> <span class='kw'>raster</span><span class='kw'>::</span><span class='fu'>rasterToPolygons</span>(<span class='no'>cost</span>)
<span class='no'>model_spdf</span> <span class='kw'>&lt;-</span> <span class='fu'>maxtargets_model</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>cost_spdf</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='no'>f</span>, <span class='kw'>budget</span> <span class='kw'>=</span> <span class='no'>b_25</span>,
                               <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#methods-by-class-">Methods (by class)</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matthew Strimas-Mackey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
